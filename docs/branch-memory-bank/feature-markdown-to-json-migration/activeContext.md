# アクティブコンテキスト

## 現在の作業内容

現在、Markdownから新しいJSON形式へのマイグレーションツールを実装しています。基本的なクラス構造、コンバーター、バックアップ機能、およびCLIコマンドの実装が完了しました。

### 作業ステップ

1. ✅ 基本的なクラス構造のスケルトンを作成
2. ✅ 各ドキュメントタイプのコンバーターを実装
3. ✅ バックアップとロールバック機能を実装
4. ✅ バリデーションロジックを実装
5. ✅ マイグレーションCLIコマンドを開発
6. ⬜ テストを作成して実装を検証

## 直近の変更点

- MarkdownToJsonMigratorクラスの実装
- 各ドキュメントタイプのコンバーターの実装
- MigrationBackupクラスの実装
- MigrationValidatorクラスの実装
- MigrateCommandの実装
- 必要なユーティリティの追加

## 今アクティブな決定事項

- ストラテジーパターンを使用して、各ドキュメントタイプごとに専用のコンバーターを実装する
- マイグレーション前に自動バックアップを作成し、問題発生時にロールバックできるようにする
- Zodを使用して生成されたJSONの検証を行う
- CLIコマンドは、ディレクトリ単位またはファイル単位でのマイグレーションをサポートする

## 今アクティブな考慮点

- どのようにドキュメントタイプを検出するか（ファイルパス、内容分析、またはその両方）
  → 実装では、ファイルパスとコンテンツの両方を分析し、タイプを検出することにした
- 同時に大量のファイルを処理する場合のパフォーマンス最適化
  → 現状は逐次処理だが、将来的には並列処理も検討する価値がある
- マイグレーション失敗時のエラーハンドリングと報告方法
  → 詳細なエラーレポートと、バックアップからのロールバック機能を実装した
- 以前のフェーズで作成されたJSONスキーマとの互換性確保
  → 既存のスキーマ定義をそのまま利用し、Zodバリデーションでスキーマ準拠を確認

## 次のステップ

1. ユニットテストの作成
2. 実際のドキュメントを使った統合テスト
3. エッジケースの考慮と改善
4. ドキュメントの更新