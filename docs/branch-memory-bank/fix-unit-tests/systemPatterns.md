# システムパターン

## 技術的決定事項

### ロギング改善

#### コンテキスト

テスト実行時にログ出力が邪魔になり、テスト結果が見づらい問題があった

#### 決定事項

loggerにsilentモードを追加し、テスト環境ではデフォルトでログを表示しないようにした

#### 影響

- テスト出力が読みやすくなった
- テスト環境と本番環境の動作を切り分けやすくなった
- テスト実行時のパフォーマンスが向上した

### エラーメッセージの統一

#### コンテキスト

エラーメッセージに「global memory bank」や「branch memory bank」といった実装詳細が含まれ、テストが壊れやすくなっていた

#### 決定事項

エラーメッセージをシンプルかつ一貫性のあるものに変更した（例：「Failed to get document from global memory bank」→「Failed to find document by path」）

#### 影響

- テストが実装の細部に依存しなくなり、堅牢になった
- エラーメッセージがユーザーにとって理解しやすくなった
- コードのリファクタリングがしやすくなった

### 正規表現の改善

#### コンテキスト

Markdownの解析において、「.*?」を使った正規表現がセクション間の区切りを正確に認識できていなかった

#### 決定事項

「.*?」の代わりに「[^#]*」を使用し、マークダウンのセクション区切り文字（#）を明示的に除外するようにした

#### 影響

- Markdownの解析が正確になり、期待通りの結果が得られるようになった
- 特に空のセクションや連続するセクションの処理が改善された
- コードの意図が明確になり、メンテナンス性が向上した