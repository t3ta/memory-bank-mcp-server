# アクティブコンテキスト

## 現在の作業内容

JSON形式でタグインデックスを永続化する機能の実装が完了しました。既存のUpdateTagIndexUseCaseを拡張し、V2として実装しました。ブリッジパターンを使って旧形式と新形式の互換性を保ちつつ実装しています。

## 最近の変更点

- タグインデックス用のJSONスキーマを作成
- UpdateTagIndexUseCaseV2を実装し、JSONインデックスファイルへの保存処理を追加
- リポジトリインターフェースを拡張してタグインデックスの保存・読み込み機能を追加
- FileSystemTagIndexRepositoryV1Bridgeを実装してV2とV1の橋渡しとした
- DIコンテナの設定を修正して、新しいリポジトリとユースケースを使用するように変更

## アクティブな決定事項

- JSON形式でタグインデックスを永続化する
- タグをキー、ドキュメントパスの配列を値とするJSON形式のインデックスを採用
- ブランチごとのタグインデックスとグローバルタグインデックスを別々に管理する
- 既存のファイル命名規則に合わせ、ブランチ用は'_index.json'、グローバル用は'_global_index.json'という名前で保存
- V2用のリポジトリ実装が既に存在していたため、それとの互換性のためにブリッジパターンを使用

## 検討事項

- タグインデックスの更新頻度の最適化
  - 現状は都度更新されるが、将来的にはバッチ処理や増分更新の仕組みを検討
- 将来的なデータベース移行に備えた設計の見直し
- 大量のドキュメントやタグが存在する場合のインデックスパフォーマンス

## 次のステップ

- タグインデックスを使った高速検索機能の実装・最適化
- 新形式のインデックスを使う実装に完全移行
- インデックスのパフォーマンス測定と改善
- テストケースの拡充