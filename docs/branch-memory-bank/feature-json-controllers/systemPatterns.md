# システムパターン

## 技術的決定事項

### テストフレームワーク

#### コンテキスト

テストフレームワークを選択する必要がある

#### 決定事項

Jestを使用する

#### 影響

- TypeScriptとの統合が良い
- モック機能が充実

### ディレクトリ構造

#### コンテキスト

ファイル配置の規則を定義する必要がある

#### 決定事項

クリーンアーキテクチャに従う

#### 影響

- 関心の分離が明確
- テスト可能性の向上

### コントローラー分離

#### コンテキスト

JSONドキュメントとMarkdownドキュメントの処理を同じコントローラーで扱うと
コードが肥大化し、メンテナンス性が低下する

#### 決定事項

JSONドキュメント専用のコントローラーを作成し、インターフェースを分離

#### 影響

- 関心の分離が明確になる
- 各コントローラーがより集中した機能を持つ
- 将来の拡張が容易になる
- 既存コードへの影響を最小限に抑える

### レスポンス形式

#### コンテキスト

異なるクライアントでの利用を考慮したレスポンス形式の標準化が必要

#### 決定事項

メタデータをサポートするMCPレスポンス形式を採用

#### 影響

- クライアント側でのコンテキスト情報の取得が容易になる
- バージョニングのサポートが容易
- レスポンスの拡張性が向上
- 後方互換性の維持が可能

### プレゼンターパターン

#### コンテキスト

異なる形式のレスポンスを統一的に扱うための抽象化が必要

#### 決定事項

IResponsePresenterインターフェースを導入し、複数のプレゼンター実装を許容

#### 影響

- レスポンス形式の変更が容易になる
- 新しいプレゼンターの追加が容易
- コントローラーとプレゼンテーションの関心を分離
- テスタビリティの向上

