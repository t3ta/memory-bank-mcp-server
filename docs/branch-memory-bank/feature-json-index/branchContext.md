# ブランチコンテキスト - feature/json-index

## 目的

このブランチでは、メモリードキュメントのタグインデックスをJSON形式で永続化する機能を実装します。これにより、タグを用いた高速な検索機能を提供し、アプリケーションの再起動後もインデックス情報を維持できるようにします。

## 背景

現状の`UpdateTagIndexUseCase`はタグ情報を収集するものの、それを永続化する実装が存在しません。コメントにも「In a real implementation, we would update a tag index persistently here」と記載されているとおり、実際のインデックス更新処理は未実装です。

プロジェクト全体でJSON形式によるドキュメント管理への移行が進んでいることから、タグインデックスもJSON形式で保存・管理する方針に合わせます。

## ユーザーストーリー

### 解決したい課題

- タグベースの検索が遅い（現状は毎回全ドキュメントスキャンが必要）
- アプリケーション再起動後にタグ情報が失われる
- 大量のドキュメントがある場合にパフォーマンス問題が発生する

### 必要な機能

1. JSON形式でのタグインデックス保存
   - ブランチごとのタグインデックス
   - グローバルタグインデックス
   
2. インデックスの管理
   - インデックスの完全再構築機能
   - ドキュメント更新時のインデックス増分更新
   
3. タグベースの検索
   - 指定したタグを持つドキュメントの高速検索
   - 複数タグの論理演算（AND/OR）による検索

### 期待される動作

- タグインデックスが自動的に維持され、最新の状態を反映すること
- ドキュメント操作（作成・更新・削除）に応じてインデックスが更新されること
- タグベースの検索が高速に実行されること
- アプリケーション再起動後もインデックス情報が保持されること

## 技術的制約

- Clean Architectureの原則に従い、ドメイン層とアプリケーション層の分離を維持すること
- 既存のUpdateTagIndexUseCaseを拡張する形で実装すること
- テスト可能な設計にすること
- 将来的なデータベース移行を見据えた設計にすること

## 関連するコンポーネント

- UpdateTagIndexUseCase
- IBranchMemoryBankRepository
- IGlobalMemoryBankRepository
- FileSystemBranchMemoryBankRepository
- FileSystemGlobalMemoryBankRepository
- BranchInfo
- Tag
