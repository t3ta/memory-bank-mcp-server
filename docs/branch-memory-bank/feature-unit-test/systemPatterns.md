# システムパターン

## 技術的決定事項

### テストカバレッジ目標

#### コンテキスト
プロジェクトのコード品質を確保するためにテストカバレッジの目標設定が必要です。

#### 決定事項
コア機能（特にドメインとアプリケーションレイヤー）は80%以上のカバレッジを目指します。初期段階では70%を目標とし、徐々に向上させていきます。

#### 影響
- コア機能の信頼性が高まる
- リグレッションの早期発見が可能になる
- 継続的なカバレッジ改善のモチベーションになる

### モックとスタブの利用戦略

#### コンテキスト
外部依存性を持つコンポーネントのテスト方法を決定する必要があります。

#### 決定事項
依存性は適切にモック化し、テスト対象を分離します。Jestのjest.fn()、jest.mock()機能を活用します。

#### 影響
- テスト実行が高速化
- テスト対象を分離して単体でテスト可能
- 外部システムに依存せずテスト実行が可能

### テストファイル配置戦略

#### コンテキスト
テストファイルをどこに配置するかの方針が必要です。

#### 決定事項
ドメインおよびアプリケーションレイヤーのテストは、対象ファイルと同じディレクトリ内の__tests__ディレクトリに配置します。インフラストラクチャとインターフェースレイヤーのテストも同様の構造で実装します。

#### 影響
- ドメインとアプリケーションのテストは、実装と近い場所に配置されるため関連性が明確
- テストファイルが実装と近いため、変更時に見つけやすく維持しやすい

### ユニットテストフレームワークとしてJestを採用

#### コンテキスト
TypeScriptプロジェクトに適したテストフレームワークが必要です。

#### 決定事項
Jestとts-jestを使用してテストを実装します。すでにプロジェクトに導入されており、TypeScriptとの親和性が高いためです。

#### 影響
- TypeScriptコードをそのままテスト可能
- モック機能が充実しており、依存性の分離が容易
- スナップショットテストやカバレッジレポート機能も利用可能

## 関連ファイルとディレクトリ構造
