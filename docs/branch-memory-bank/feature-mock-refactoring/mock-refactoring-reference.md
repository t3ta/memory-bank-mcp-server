# モック置き換え計画の参照

## 概要

テスト修正作業の一環として、モックの実装方法を改善するための計画を作成しました。この計画は、現在のテストコードで発生している問題（特にモックの重複や一貫性の欠如）に対処するものです。

## 関連する既知の問題

現在の進捗状況（`progress.json`）に記載されている以下の問題に対応します：

1. **統合テストの失敗**
   - `global-controller.test.ts`内でglobalDirが未定義の問題
   - モックの適切な実装により解決可能

2. **Mockライブラリの不一致**
   - vitestとjestのモックの仕組みに違いがあり、一部のテストでモックの挙動が期待と異なる
   - ts-mockitoを一貫して使用することで解決可能

## 詳細計画

詳細な計画は [mock-refactoring-plan.md](./mock-refactoring-plan.md) に記載されています。この計画には以下の内容が含まれています：

- 現状分析と問題点
- 改善計画（フェーズ分け）
- 実装詳細と例
- 移行スケジュール
- 期待される効果
- リスクと対策

## 実装状況

現在、以下の実装が完了しています：

1. `global-controller.test.ts`の修正
   - 適切なモックの実装により、テストが正常に動作するようになりました
   - ファイル削除テストとタグ検索テストの問題を解決

2. モック置き換え計画の作成
   - 今後のテスト修正作業のためのガイドラインとして活用可能

## 次のステップ

1. 共有モックライブラリの基盤実装
   - `tests/mocks/` ディレクトリの作成
   - 基本モックファクトリの実装

2. 優先度の高いテストから移行
   - 残りの統合テストの修正
   - 特に `BranchController.test.ts` および `ContextController.test.ts` のモック挙動の修正

## コアファイルへの参照

このモック置き換え計画は、プロジェクトの品質向上と保守性の改善に貢献します。特に以下のコアファイルと関連しています：

- **テスト駆動開発**: テストの品質と信頼性の向上
- **コーディング規約**: 一貫したモック実装のためのガイドライン
- **アーキテクチャ**: テストコードの構造化と整理
