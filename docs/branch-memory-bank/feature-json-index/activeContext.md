# アクティブコンテキスト

## 現在の作業内容

JSON形式でタグインデックスを永続化する機能の実装が完了しました。インポートパスの問題を修正し、既存のリポジトリインターフェースへのタグインデックス操作メソッドの追加も無事に終わりました。ブリッジパターンを使って旧形式と新形式の互換性を保ちつつ実装しています。

## 最近の変更点

- TagIndexのインポートパスの拡張子を.jsから.tsに修正（全ファイル）
- IBranchMemoryBankRepositoryとIGlobalMemoryBankRepositoryのimport文を修正
- FileSystemBranchMemoryBankRepositoryとFileSystemGlobalMemoryBankRepositoryのimport文を修正
- 旧実装のFileSystemTagIndexRepository.tsを正式に削除

## アクティブな決定事項

- JSON形式でタグインデックスを永続化する
- タグをキー、ドキュメントパスの配列を値とするJSON形式のインデックスを採用
- ブランチごとのタグインデックスとグローバルタグインデックスを別々に管理する
- 既存のファイル命名規則に合わせ、ブランチ用は'_index.json'、グローバル用は'_global_index.json'という名前で保存
- V2用のリポジトリ実装が既に存在していたため、それとの互換性のためにブリッジパターンを使用

## 検討事項

- JSON形式での巨大なタグインデックスのパフォーマンス最適化
- ブランチとグローバル両方でのインデックス更新処理の統一
- 頻繁なインデックス更新による不要なディスクI/Oの削減方法
- インポートパスでのTypeScript・JavaScript拡張子の一貫性の確保

## 次のステップ

- 旧タグインデックス実装への依存をすべて新しいJSON形式に置き換える
- テストケースの拡充とエッジケースのテスト追加
- インデックスのパフォーマンス測定と改善
- 新形式を使った検索機能のパフォーマンス最適化